---
title: BIOS-1
date: 2020-02-18 23:46:31
tags: 随笔
categories: [软件,固件]
---

### BIOS(Basic Input/Output System)

**概述:**
* 基本输入输出系统
* 亦称为ROM BIOS、System BIOS、PC BIOS
* 是在通电引导阶段运行硬件初始化，以及为操作系统和程序提供运行时服务的固件
* BIOS最早随着CP/M操作系统的推出在1975年出现
* BIOS预安装在个人电脑的主板上，是个人电脑启动时加载的第一个软件
* BIOS用于初始化和测试系统的硬件组件，以及从大容量存储设备(如硬盘)加载引导程序，并由引导程序加载操作系统
* 可以理解为是一组固化到计算机内主板上一个ROM芯片上的程序，用于保存计算的基本输入输出的程序以及开机后自检程序和系统自启动程序
* 从CMOS中读写系统设置的具体信息
* 其主要功能是为计算机提供最底层的、最直接的硬件设置和控制

**相关:**

* 许多BIOS程序都只能在特定电脑型号或特定主板型号上运行
* 早年的BIOS存储于ROM芯片上
* 而现在的BIOS多存储于闪存芯片上，以方便BIOS更新
* 许多较新的操作系统在引导后不再通过BIOS访问硬件
* 系统硬件的变化是由BIOS隐藏，程序使用BIOS功能而不是直接控制硬件
* 现代操作系统会忽略BIOS提供的抽象层并直接控制硬件组件
---
* 大约从80386 PC开始，个人电脑的BIOS ROM集成了设置程序(Setup)
* 主板的CMOS芯片用于存储BIOS设置值及硬件侦测值
* 主板上的钮扣电池用于让CMOS存储BIOS设置值，以及电脑在断电时依然可以让系统时钟运作
---
* BIOS还为DOS操作系统提供键盘、显示及其他I/O设备的硬件抽象层
> BIOS可通过BIOS中断调用为MS-DOS操作系统及MS-DOS程序提供磁盘、键盘、显示等标准服务
> 通过BIOS中断调用访问视频硬件非常缓慢，因此，有些DOS程序(尤其是游戏)通过直接访问视频硬件提高效率
* 现代操作系统仅在操作系统引导时通过BIOS中断调用访问硬件
* 现代的BIOS可以让用户选择由哪个引导设备引导电脑，如光盘驱动器、硬盘、软盘、U盘等等
* 旧式的BIOS多半已被UEFI所取代
---
* 自P6微架构开始，Intel处理器支持可重新编程的微码
* BIOS可能包含处理器微代码更新
* 一些BIOS支持超频
---
* BIOS以16位实模式运行
> 现代操作系统以保护模式或长模式运行，访问BIOS的16位实模式服务(如BIOS中断调用)是低效的
> 现代操作系统仅在引导时使用BIOS中断调用服务
> 后来的BIOS加入了APM、即插即用规范(PnP)，ACPI等功能

---

### 运行流程(系统引导)

1. 当计算机通电之后，BIOS就会从主板上的ROM芯片运行
2. 运行加电自检(POST)
3. 测试和初始化CPU，RAM，直接存储器访问控制器，芯片组，键盘，软盘，硬盘等设备
4. 当所有的Option ROM被加载后，BIOS就试图从引导设备(如硬盘、软盘、光盘)加载引导程序，由引导程序加载操作系统

* BIOS也可从网卡等设备引导

---

### BIOS固件
* 由于BIOS与硬件系统集成在一起(将BIOS程序指令刻录在IC中)，所以有时候也被称为固件
* 在大约1990年BIOS是保存在ROM(只读存储器)中而无法被修改
* 因为BIOS的大小和复杂程度随时间不断增加，而且硬件的更新速度加快，令BIOS也必须不断更新以支持新硬件
> 于是BIOS就改为存储在EEPROM或者闪存中，让用户可以轻易更新BIOS

* 不适当的运行或是终止BIOS更新可能导致电脑无法使用
> 为了避免BIOS损坏，有些主板有备份的BIOS("双BIOS"主板)
> 现在的BIOS有"引导区块"(Boot Block)，属于BIOS ROM的一部分，一引导就会被运行
> 这个程序会在运行BIOS前，验证BIOS其他部分是否正确无误(经由检查码，凑杂码等等)
> 如果引导区块侦测到主要的BIOS已损坏，则可自动读取U盘/光盘中的特定BIOS文件并更新BIOS
> 主板厂商/OEM经常发出BIOS升级来更新他们的产品和修正已知的问题

---

### CMOS与BIOS

* CMOS是计算机上另一个重要的存储器
* BIOS程序的设置值，硬件参数侦测值被保存在CMOS之中
> 而且在BIOS程序引导计算机时，需要加载CMOS中的设置值
* CMOS通常被集成在南桥芯片组中
* UEFI系统则多用NVRAM存储设置

**BIOS与CMOS的区别**

* BIOS是存储在唯读记忆体(EEPROM)
* CMOS为随机存储器(RAM)
* BIOS中存储的是程序，而CMOS中存储的是普通信息
* CMOS的内容在断电会消失
> 所以把主板的电池拆出便可重置其内容，同时拆出电池也会重置时间

---

### 扩展程序（Option ROM）

* 扩展卡如硬盘控制器、显卡、网卡可能包含BIOS扩展程序(即Option ROM)以为BIOS提供附加的功能
* 在BIOS引导操作系统前，Option ROM被BIOS运行
* 部分内置于主板的设备(如板载RAID)，其Option ROM可能包含在主板BIOS中
* Option ROM通过BIOS引导规范扩展BIOS的引导功能

**系统初始化**

* 系统在加电自检(POST)阶段，查找并运行Option ROM
* Option ROM通过BIOS中断调用对硬件进行测试，初始化，并显示诊断信息或显示设置画面

---

### UEFI简述:

* 因特尔于2000年开发出可扩展固件接口(Extensible Firmware Interface)
* 随后，由业界多家著名公司共同成立统一可扩展固件接口论坛(UEFI Forum)
* EFI被更名为UEFI，且由UEFI论坛制定新的UEFI规范
* 现时UEFI已经取代传统BIOS，且Intel将于2020年弃用传统BIOS接口
* 届时Intel产品不再支持基于16位实模式的UEFI CSM(UEFI兼容性支持模块)

---

### 相关概念:

* BIOS
* SMBIOS
* UEFI
* CMOS
* Option ROM
* 固件
* ACPI
> 高级配置与电源接口(Advanced Configuration and Power Interface)
* VEB
> VESA BIOS Extensions是VESA制定的标准
* Aptio
> AMI基于UEFI规范的下一代BIOS固件
> 将被应用于未来固件可移植性和可扩展性的发展
* El Torito
> 可引导光盘规格

