---
title: 数据类型-6
date: 2020-03-13 13:13:26
tags: [随笔,C]
categories: [软件,C/C++]
---


<center><strong>数据类型-语句/控制语句-2</strong></center>
    
<!-- more -->

## 数据类型-6

* 循环结构内容补充(控制结构)
> for循环
> do while循环
> 数组与循环
> 函数与循环
> 其它赋值运算符

---

## for循环

* for循环将循环语句最基本的三种行为(初始化，测试和更新)组合在一处
> 其基本的语法格式为: `for (xxx;xxx;xxx){}`

* 关键字for后面的圆括号中的若干个表达式用分号相隔，一般在圆括号中会有至少三个表达式
* 即为初始化表达式，测试条件表达式，更新执行表达式
> 还可将其称之为包含了循环所需的所有信息: 所选变量的初值，所选变量的终值，所选变量的循环条件(条件表达式或为自增或自减)
* 在花括号内可以添加简单语句和复合语句
* 测试表达式的值为真时则继续循环，为假时则停止循环，其它关于的循环基本概念在[数据类型-5](http://unit-serow.com/2020/03/12/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-5/#more)内有详细介绍

* 还可以将for语句圆括号内的表达式称之为控制表达式，它们都是完整的表达式，所以每个表达式的副作用(例如递增变量之类的)都发生在对下一个表达式求值之前

**for循环的结构图示**

* for循环的结构:

<img src="/images/数据结构-6/for循环的结构-1.png" width="40%" height="40%">

---

**利用C 内 for的灵活性**

* 虽然for循环看上去和FORTRAN的DO循环，Pascal的FOR循环，ASIC 的FOR...NEXT循环类似
> 但是for循环比这些循环灵活
> 这些灵活性源于如何使用for循环中的3个表达式
> 即为: 1-初始值(变量经由初始化得到的值)，2-条件表达式，3-返回类型所需要执行的某种方法(或称其为每次迭代需要执行的条件)
> 第3个表达式可以使用任意合法的表达式
> 无论是什么表达式，每次迭代都会更新该表达式的值
> for循环中的3个表达式可以是不同的变量(注意，虽然该例可以正常运行，但是编程风格不太好，如果不在更新部分加入代数计算，程序会更加清楚)
> 可以省略一个或多个表达式(但是不能省略分号)，只要在循环中包含能结束循环的语句即可
> 这句话的意思就是，可以不在圆括号内写条件的表达式，而在for()代码行下对for语句进行说明，此时被进行说明的语句必须带有结束表示分号
> 有没有花括号无所谓，添加花括号的理由是为了让代码更整洁且直观
> 这样使用for循环确实很像其他语言的循环
> 除此之外，C 的for循环还有其他9种用法

* 需要注意的要点-1: 在执行循环的其他部分之前，只对第一个表达式求值一次或执行一次
* 同时对于循环体中的行为可以改变循环头中的表达式，此时需要用到if语句与选择语句的概念，即为在for语句中添加复合语句，该复合语句用于执行if等条件选择语句，也可称该复合语句为代码块

* for语句的一般形式
```
for ( initialize; test; update )
statement
```
在test为假或0之前，重复执行statement部分

* 示例语句:
```
for (n = 0; n < 10 ; n++)
printf(" %d %d\n", n, 2 * n + 1);
```

---

## 其它赋值运算符

* 包括`+=`，`-=`，`*=`，`/=`，`%=`

* C有许多赋值运算符
> 最基本，最常用的是=，它把右侧表达式的值赋给左侧的变量
> 其他赋值运算符都用于更新变量，其用法都是左侧是一个变量名，右侧是一个表达式
> 赋给变量的新值是根据右侧表达式的值调整后的值
> 而确切的调整方案取决于具体的运算符

* 例如:
> `scores += 20` 与 `scores = scores + 20` 相同
> `dimes -= 2` 与 `dimes = dimes - 2` 相同
> `bunnies *= 2` 与 `bunnies = bunnies * 2` 相同
> `time /= 2.73` 与 `time = time / 2.73` 相同
> `reduce %= 3` 与 `reduce = reduce % 3` 相同

* 上述所列的运算符右侧都使用了简单的数，还可以使用更复杂的表达式
* 例如：
> `x *= 3 * y + 12 与 x = x * (3 * y + 12)` 相同
* 以上提到的赋值运算符与`=`的优先级相同，即比`+`或`*`优先级低
> 上面最后一个例子也反映了赋值运算符的优先级，`3 * y`先与`12`相加，再把计算结果与`x`相乘，最后再把乘积赋给x
> 并非一定要使用这些组合形式的赋值运算符
> 但是，它们让代码更紧凑，而且与一般形式相比，组合形式的赋值运算符生成的机器代码更高效
> 当需要在`for`循环中塞进一些复杂的表达式时，这些组合的赋值运算符特别有用

* 通常在for的循环头内就能完成大量的工作

---

### 逗号运算符

* 逗号运算符扩展了for循环的灵活性，以便在循环头中包含更多的表达式
* 基本使用语法:
> `for (ounces = 1, cost = FIRST_OZ; ounces <= 16; counces++,cost += NEXT_OZ)`
> 这里的`FIRST_OZ`和`NEXT_OZ`是常量数据类型，`NEXT_O`的值是20
> 在初始化表达式中使用了逗号来对ounces和cost都进行了初始化
> 同时也在更新表达式中使用逗号来表示每次执行迭代时ounces递增1与cost递增20(因为`NEXT_Z`的值是20)

* 逗号运算符的作用就是在同一个表达式区块内进行多组条件的声明
> 比如在初始化表达式区块中，同时对两个变量进行初始化，或者在更新表达式中声明两个不同的变量在迭代时使用的规则与条件

* 逗号运算符并不局限于在for循环中使用，但是这是它最常用的地方
> 逗号运算符有两个其他性质
> 首先，它保证了被它分隔的表达式从左往右求值(换言之，逗号是一个序列点，所以逗号左侧项的所有副作用都在程序执行逗号右侧项之前发生)
> 因此，ounces在cost之前被初始化
> 在该例中， 顺序并不重要，但是如果cost的表达式中包含了ounces时，顺序就很重要
> 例如，假设有下面的表达式:
> `ounces++, cost = ounces * FIRST_OZ`
> 在该表达式中，先递增ounce，然后在第2个子表达式中使用ounce的新值
> 作为序列点的逗号保证了左侧子表达式的副作用在对右侧子表达式求值之前发生
* 其次，整个逗号表达式的值是右侧项的值

**图解说明逗号表达式的执行逻辑**

* 逗号运算符和for循环:

<img src="/images/数据结构-6/逗号运算符和for循环-1.png" width="40%" height="40%">

* 在进行复杂的计算之前，可以先看看数学上是否有简单的方法可用

---

### do while

* 出口条件循环
* while循环和for循环都是入口条件循环，即在循环的每次迭代之前检查测试条件，所有有可能根本不执行循环体中的内容
* C 中的出口条件循环(exit-condition loop)的作用是在循环的每次迭代后检查测试条件，以保证至少执行循环体中的内容以此，这种循环被称为do while循环

* do while循环的通用形式：
```
do
statement
while ( expression );
```

* 在test为假或0之前，重复执行statement部分
* 示例程序:
```
do
scanf("%d",　&number);
while　(number　!=　20);
```

* statement可以是一条简单语句或复合语句
> 注意，do while循环以分号结尾
> do while循环在执行完循环体后才执行测试条件，所以至少执行循环体一次
> 而for循环或while循环都是在执行循环体之前先执行测试条件
> dowhile循环适用于那些至少要迭代一次的循环
> 例如，对用户输入的密码进行测试的程序

* do while循环的结构示意图:

<img src="/images/数据类型-6/do while循环结构-1.png" width="40%" height="40%">

* 其它注解:
* do while语句创建一个循环，在expression为假或0之前重复执行循环体中的内容
> do while语句是一种出口条件循环，即在执行完循环体后才根据测试条件决定是否再次执行循环
> 因此，该循环至少必须执行一次
>  statement部分可是一条简单语句或复合语句

---

### 关于对循环的选择

* 首选需要确定是需要入口条件循环还是出口条件循环
* 通常，入口条件循环用的比较多
* 有几个原因: 
> 其一，一般原则是在执行循环之前测试条件比较好
> 其二，测试放在循环的开头，程序的可读性更高
> 另外，在许多应用中，要求在一开始不满足测试条件时就直接跳过整个循环
> 那么，假设需要一个入口条件循环，用for循环还是while循环取决于个人喜好，因为二者皆可

* 要让for循环看起来像while循环，可以省略第1个和第3个表达式
> `for ( ; test ; )`与此的while效果相同: `while ( test )`

* 要让while循环看起来像for循环，可以在while循环的前面初始化变量， 并在while循环体中包含更新语句
* 例如:
```
初始化;
while ( 测试 )
{
其他语句
更新语句
}
```
* 与下面的for循环效果相同:
> `for ( 初始化 ;测试 ; 更新 )`

**其他语句:**

* 一般而言，当循环涉及初始化和更新变量时，用for循环比较合适
> 而在其他情况下用while循环更好
* 对于下面这种条件，用while循环就很合 适：
> `while (scanf("%ld", &num) == 1)`
* 对于涉及索引计数的循环，用for循环更适合
* 例如:
> `for (count = 1; count <= 100; count++)`

---

### 嵌套循环

* 嵌套循环(nested loop)指在一个循环内包含另一个循环
> 嵌套循环常用于按行和列显示数据，也就是说，一个循环处理一行中的所有列，另一个循环处理所有的行

* 示例程序:
```
#include <stdio.h>
#define ROWS 6
#define CHARS 10

int main(void)
{
	int row;
	char ch;
	for (row=0;row<ROWS;row++)
	{
		for (ch='A';ch<('A'+CHARS);ch++)
			printf("%c", ch);
		printf("\n");
	}
	return 0;
}
```

* 输出结果:
```
ABCDEFGHIJ
ABCDEFGHIJ
ABCDEFGHIJ
ABCDEFGHIJ
ABCDEFGHIJ
ABCDEFGHIJ
```

* 程序分析:
> 第10行开始的for循环被称为外层循环(outer loop)
> 第12行开始的for循环被称为内层循环(inner loop)
> 外层循环从row为0开始循环，到row为6时结束
> 因此，外层循环要执行6次，row的值从0变为5
> 每次迭代要执行的第1条语句是内层的for循环，该循环要执行10次，在同一行打印字符A～J
> 第2条语句是外层循环的printf("\n");
> 该语句的效果是另起一行，这样在 下一次运行内层循环时，将在下一行打印的字符
> 注意，嵌套循环中的内层循环在每次外层循环迭代时都执行完所有的循环
> 在程序中，内层循环一行打印10个字符，外层循环创建6行

* 此实例中，内层循环和外层循环所做的事情相同
* 可以通过外层循环控制内层循环，在每次外层循环迭代时内层循环完成不同的任务
> 比如可以根据上面的程序来修改内层循环条件
> 比如让row和A相加，而因为ch是char类型的，所以每次迭代所带来的结果就是将其初始化为不同的字符，所以程序每次对字符的打印数量都会比上一行少一个，如果没有改变测试条件，每行依旧会以F结尾
> 还可称其为依赖外部循环的嵌套循环，只不过不应该存在这种说法，因为这只是最基本的线性逻辑

---

### 关于在循环中使用数组

* 因为循环内经常需要用到数组，这里先对数组进行简单的说明
> 数组可以作为一种存储多个相关项的便利方式

* 数组(array)是按顺序存储一系列类型相同的值，如10个char类型的字符或15个int类型的值
> 整个数组有一个数组明，通过整数下标来访问数组中单独的项或元素(element)

* 以下是对数组进行声明的基本语法格式:
> float debts[20];

* 声明debts是一个内含20个元素的数组，每个元素都可以存储float类型的值
> 数组的第一个元素是debts[0]，第二个元素是debts[1]，以此类推，直到debts[19]
> 这里需要进行注意的一点就是，数组元素的编号从0开始，而非1
> 此时可以给每个元素赋float类型的值

* 赋值的基本语法格式:
> debt[6] = 32.49;
> debt[7] = 1.2e+21;

* 实际上，使用数组元素和使用同类型的变量意义
> 例如，可以这样把值读入指定的元素之中:
> scanf("%f", &debts[4]);

* 这里要注意个潜在的陷阱，考虑到影响执行的速度，C 编译器不会检查数组的下标是否正确
> 所以千万不要书写和使用数组中不存在的元素，因为编译器不会查找这样的错误
> 当运行程序时，这种情况会导致数据被放在在已被其它数据占用的地方，可能会破坏程序的结果甚至导致程序因异常而中断

* 数组的类型可以是任意的数据类型
> int nannies[22];
> char actors[26];
> long big[500];

* 可以把字符串存储在char类型的数组中(一般而言，char类型数组的所有元素都存储char类型的值)
> 如果char类型的数组末尾包含了一个表示字符串末尾的空字符\0，则该数组的内容就构成了一个字符串

* 图解字符串数组和字符串:

<img src="/images/数据类型-6/字符串和字符串数组.png" width="40%" height="40%">

* 用于识别数组元素的数字被称为下标(subscript)，索引(indice)或偏移量(offset)
> 下标必须是整数，而且要从0开始计数
> 数组内的元素依次被存储在内存中相邻的为止

* 图解内存中的char和int类型的数组:

<img src="/images/数据类型-6/内存中的char和int类型的数组.png" width="40%" height="40%">

* 在for循环中可以使用数组，也就是使用循环来处理数组

* 在调整循环语句的逻辑描述时，要时刻遵守模块化(modularity)原则
> 模块化原则的思想就是: 应把程序划分为一些独立的单元，每个单元执行一个任务
> 这样做能够提升程序的可读性
> 最重要的是，模块化使程序的不同部分彼此独立，方便以后更新或修改程序
> 还可以将每个执行任务的单元放进函数中，提高程序的模块化

---

* 在循环内使用函数的返回值
* 使用带返回值的函数
* 此部分可能会被补充

---

### 概念归纳

* 循环是一个强大的编程工具
> 在创建循环时，要特别注意以下3个方面:
1. 注意循环的测试条件要能使循环结束
2. 确保循环测试中的值在首次使用之前已初始化
3. 确保循环在每次迭代都更新测试的值

* C通过求值来处理测试条件，结果为0表示假，非0表示真
> 带关系运算符的表达式常用于循环测试，它们有些特殊
> 如果关系表达式为真，其值为 1
> 如果为假，其值为0
> 这与新类型`_Bool`的值保持一致

* 数组由相邻的内存位置组成，只储存相同类型的数据
> 记住，数组元素的编号从 0 开始，所有数组最后一个元素的下标一定比元素数目少1
> C编 译器不会检查数组下标值是否有效，自己要多留心

* 使用函数涉及3个步骤:
1. 通过函数原型声明函数
2. 在程序中通过函数调用使用函数
3. 定义函数

* 函数原型是为了方便编译器查看程序中使用的函数是否正确
> 函数定义描述了函数如何工作
> 现代的编程习惯是把程序要素分为接口部分和实现部分，例如函数原型和函数定义
> 接口部分描述了如何使用一个特性，也就是函数原型所做的
> 实现部分描述了具体的行为，这正是函数定义所做的

---

* 在便于理解的前提下，对代码的总体大小进行优化
> 易于理解和维护的代码才是好代码
> 没必要去理解或书写一些逻辑严谨到夸张的地步和使用一大片符号类型的代码
> 可以将一句逻辑严谨的代码写成两句或三句便于理解的代码，当然是在保持美观的前提下
> 即模块化原则

---

**内容来自原书第六章节**

---



