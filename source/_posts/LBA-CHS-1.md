---
title: LBA/CHS/RAID-1
date: 2020-02-19 02:09:34
tags: 随笔
categories: [软件,Disk]
---

## LBA/CHS/RAID-1

* LBA(寻址模式)-1
* CHS(寻址模式)-1
* RAID(磁盘阵列)-1

### LBA-寻址模式

**简述:**
* LBA寻址模式
* 逻辑区块地址(Logical Block Address, LBA)
* 是描述电脑存储设备上数据所在区块的通用机制，一般用在像硬盘这样的辅助记忆设备
* LBA可以意指某个数据区块的地址或是某个地址所指向的数据区块
> 现今电脑上所谓一个逻辑区块通常是512或1024位组
> ISO-9660格式的标准CD则以2048位组为一个逻辑区块大小

---

**LBA定址机制:**
* LBA是非常单纯的一种定址模式:从0开始编号来定位区块，第一区块LBA=0，第二区块LBA=1，依此类推
* 这种定址模式取代了原先操作系统必须面对存储设备硬件构造的方式
> 最具代表性的首推CHS(cylinders-heads-sectors，磁柱-磁头-扇区)定址模式
> 区块必须以硬盘上某个磁柱、磁头、扇区的硬件位置所合成的地址来指定
> CHS模式对硬盘以外的设备来说没什么作用(例如磁带或是网络存储设备)，所以通常也不会用在这些地方
> 过去MFM(Modified Frequency Modulation, 改良调频式)和RLL(Run Length Limited)存储设备都曾使用CHS模式
> ATA-1设备更将延伸CHS(Extended Cylinders-Heads-Sectors, ECHS)也派上了用场
* SCSI采用LBA抽象定址

---

**LBA所对应的/与逻辑器件虚拟化**
> 当逻辑器件是经由虚拟化或是集合所构成的
> 像是RAID(磁盘阵列)和SANs(Storage Area Network)这种复杂的情况
> 就得把应用程序根据其观点中的磁盘来指定的LBA转换成每个实体存储设备上的LBA
* 在复杂的分布式存储结构下，从发出要求的应用程序到实体甚至是远程设备之间，会有太多这样的LBA转换

* CHS与LBA之间可以相互转换

---

**转换公式:**

* CHS地址转LBA公式
> `#lba=(#c*H+#h)*S+#s-1`

* 说明:
> `#c`,`#h`,`#s`分别是磁柱、磁头、扇区的编号
> `#lba`是逻辑区块编号
> H=heads per cylinder，每个磁柱的磁头数
> S=sectors per track，每磁道的扇区数

---

* LBA地址转CHS公式:
> #c=#lba/(S*H)
> #h=(#lba/S)%H
> #s=(#lba%S)+1

* 说明:
> `/`是整数除法
> `%`是取整数除法中的余数
> 需要注意的一点是当今的磁盘使用ZBR(Zone Bit Recording, 等密度记录)方式，实际的每轨扇区数得根据它是哪一轨
> 不过磁盘还是会提供这个参数来符合公式，内部再自动调整

---

* 其它公式:
> `#lba/S=q 余 r`
> `#s=1+r`
> `q/H=#c 余 #h`

* 例如:
> `CHS总数=[600, 10, 84]`，求`#lba=1234`所对应的CHS编号:
> `1234/84=14 余 58`
> `#s=1+58=59`
> `14/10=1 余 4`
> `#c=1`
> `#h=4`
> `#chs=(1, 4, 59)`
> 验算:`(1*10+4)*84+59-1=14*84+58=1234`

---

### CHS寻址模式

**概述:**

* CHS寻址模式
* 柱面-磁头-扇区(Cylinder-head-sector，简称为CHS)
* CHS寻址模式将硬盘划分为磁头(Heads)，柱面(Cylinder)，扇区(Sector)
* 是早期对硬盘驱动器的每一个物理数据块进行编址的一种方法
> 就软盘驱动器而言，可对同一磁盘介质进行低级格式化而得到不同的容量
---
* 磁头(Heads):每张磁片的正反两面各有一个磁头，一个磁头对应一张磁片的一个面
> 因此，用第几磁头就可以表示数据在哪个磁面
* 柱面(Cylinder):所有磁片中半径相同的同心磁道构成"柱面"，意思是这一系列的磁道垂直叠在一起，就形成一个柱面的形状
> 简单地理解:柱面数=磁道数
> 扇区(Sector)：将磁道划分为若干个小的区段，就是扇区
> 虽然很小，但实际是一个扇子的形状，故称为扇区，每个扇区的容量为512字节
---
*  知道了磁头数、柱面数、扇区数，就可以很容易地确定数据保存在硬盘的哪个位置
* 确定硬盘的容量计算公式:
> 硬盘容量=磁头数×柱面数×扇区数×512字节
---
* LARGE寻址模式把柱面数除以整数倍、磁头数乘以整数倍而得到的逻辑磁头/柱面/扇区参数进行寻址
* 所以表示的已不是硬盘中的物理位置，而是逻辑位置
---
* LBA寻址模式是直接以扇区为单位进行寻址的，不再用磁头/柱面/扇区三种单位来进行寻址
> 但为了保持与CHS模式的兼容，通过逻辑变换算法，可以转换为磁头/柱面/扇区三种参数来表示
> 但表示的也和LARGE寻址模式一样，并不是硬盘中的物理位置，而是逻辑位置

---

### RAID-磁盘阵列

* 独立硬盘冗余阵列(RAID, Redundant Array of Independent Disks)
* 旧称廉价磁盘冗余阵列(Redundant Array of Inexpensive Disks)
* 利用虚拟化存储技术把多个硬盘组合起来，成为一个或多个硬盘阵列组，目的为提升性能或数据冗余，或是两者同时提升
---
* 根据实现模式，分为软件和硬件两种：
> 软件磁盘阵列(Software RAID)
> 硬件磁盘阵列(Hardware RAID)

* 目前水平有限，文章只对RAID进行简单概述

---

### 其它概念:

* FDISK(分区)
* BOOT
* ACPI
* UEFI
* BIOS
* CHS
* LBA
* SMBIOS
* Aptio
* 硬盘固件/固件

---
