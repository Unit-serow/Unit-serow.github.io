---
title: 版本控制系统 Git-分支
date: 2020-02-03 18:51:45
tags: Git
categories: [软件,Git]
---

## Git 版本控制系统

### 远端分支的上传与本地分支的处理的执行逻辑与原理

**远端分支**

* 在本地进行任何连接Git远端服务器或远端服务器分支的操作时，远端服务器内会创建一个默认分支，之后在本地会生成一个对应该默认分支的分支
* 下文描述说明:服务器的分支被称为`origin/master`，而本地的分支被称为`master` 

**执行原理:**
* 在本地执行`git clone`命令克隆远端数据之后，git的clone会自动将所连接远端服务器命名为origin(执行该命令就是克隆URL所指定服务器内的所有数据)
* 同时在远端origin服务器内创建了指向它默认主分支(master)的指针，并在远端的服务器内为分支命名为`origin/master`(默认仓库名与此仓库内的默认分支名)
* 然后远端的git服务器也会给本地主机添加本地的master指针，该指针与远端服务器origin的master分支指向同的目标
* 从而从本地就可以操作远程服务器origin的分支了(origin的任何分支-这里指master分支)，进而实现数据推送

**逻辑关系的链接表示:**
> -表示线性执行的逻辑关系
> 本地主机-远程仓库-远程仓库内的若干个分支(分支也可以拥有分支)
> 默认远程仓库被命名为origin，而其下默认分支被默认命名为master
> 一般情况下，远程仓库内拥有最少一个默认分支，并将其默认定义为主分支，对主分支的定义可以进行改动
---

**本地分支**

**工作区，暂存区与版本库的概念与其中的关系介绍:**
* 工作区就是本地主机的文件文件目录
* 暂存区(stage或index)，一般存放在隐藏目录.git下的`index`文件中,暂存区也可以被叫做索引(index)
* 版本库 工作区内的隐藏目录`.git`就被称之为版本库，其中包含了暂存区文件，对象库，游标(HEAD)文件与本地分支等等
* 正常情况下的操作都是由工作区发出命令然后传于版本库内进行各级执行

**逻辑关系表示:**
> 工作区-[版本库-(暂存区-本地分支/对象库)]-远端服务器
> 这里的-用于表示包含，链接与单向执行逻辑

**逻辑关系:**
* 当工作区内修改或新增文件之后执行git add 命令之后，暂存区的目录会被更新
* 同时工作区修改或新增文件的内容也被写入对象库中的一个新的对象库中，而该对象的ID也被记录在暂存区的文件索引中
* 当执行提交操作`git commit`时，暂存区的目录树会写到版本库中的对象库中
* 之后默认分支master或设置的本地分支经由游标(HEAD)的指向会对所选分支作出相应的更新
* 默认分支master或设置的本地分支指向的目录树就是提交至远端时暂存区的目录树
* 进而推送暂存区的目录树(也就是本地存储于所选分支内暂存区的所有数据)至远端

**命令原理与版本库内目录简要介绍:**
* 执行`git reset HEAD(游标名)`命令时，更新暂存区操作，暂存区的目录会被重写，而被master分支的游标所指向的目录树所交换，工作区不受影响
* 执行`git rm --cached filename`命令时 ，从暂存区删除文件，而工作区不做出改变
* 执行`git checkout .`命令时重新指定本地分支，用暂存区全部或指定的文件替换工作区的文件，会清除工作区中未添加到暂存区的改动
* 执行`git checkout HEAD .`或`git checkout HEAD filename`命令时，会用游标(HEAD)指向的master分支中的全部或者部分文件替换暂存区和以及工作区中的文件，不但会清除工作区中未提交的改动，也会清除暂存区中未提交的改动
* 执行`git fetch origin`命令用于同步数据，原理就是从中抓取本地没有的数据并且更新本地数据，同时游标(HEAD)也会更新

* 对象库位于`.git/objects`目录下，里面包含了创建的各种对象及内容
* 暂存库位于`.git/index`目录下
* 游标位于`.git/HEAD`目录下

本文所描述的游标，也可以称之为指针，用指针去理解会更简单

论题由Git的连接机制而引出，因为是完全性的主观理解，执行与结构的逻辑关系可能别有出入，仅供参考
---

参考文案:

Git官网:[跳转](https://git-scm.com/)
`https://git-scm.com/`

CN-Git 分支简介:[跳转](https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%AE%80%E4%BB%8B)
`https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%AE%80%E4%BB%8B`

CN-Git 分支使用:[跳转](https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6)
`https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6`
